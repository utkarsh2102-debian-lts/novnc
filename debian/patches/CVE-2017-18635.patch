Description: CVE-2017-18635
 An XSS vulnerability was discovered in noVNC in which remote VNC server could
 inject arbitrary HTML into the noVNC web page via the messages propagated to
 the status field, such as the VNC server name.

---
Author: Abhijith PA <abhijith@debian.org>
Origin: https://github.com/novnc/noVNC/commit/6048299a138e078aed210f163111698c8c526a13#diff-286f7dc7b881e942e97cd50c10898f03L534
Bug: https://bugs.launchpad.net/horizon/+bug/1656435
Last-Update: 2019-10-04

--- a/include/ui.js
+++ b/include/ui.js
@@ -284,7 +284,7 @@
         psp.style.display = "none";
         UI.popupStatusOpen = false;
     } else {
-        psp.innerHTML = $D('noVNC_status').innerHTML;
+        psp.textContent = $D('noVNC_status').textContent;
         psp.style.display = "block";
         psp.style.left = window.innerWidth/2 - 
             parseInt(window.getComputedStyle(psp, false).width)/2 -30 + "px";
@@ -516,7 +516,7 @@
 
     if (typeof(msg) !== 'undefined') {
         $D('noVNC-control-bar').setAttribute("class", klass);
-        $D('noVNC_status').innerHTML = msg;
+        $D('noVNC_status').textContent = msg;
     }
 
     UI.updateVisualState();
--- a/include/web-socket-js/swfobject.js
+++ b/include/web-socket-js/swfobject.js
@@ -383,7 +383,7 @@
 	function abstractAltContent(obj) {
 		var ac = createElement("div");
 		if (ua.win && ua.ie) {
-			ac.innerHTML = obj.innerHTML;
+			ac.textContent = obj.textContent;
 		}
 		else {
 			var nestedObj = obj.getElementsByTagName(OBJECT)[0];
--- a/vnc_auto.html
+++ b/vnc_auto.html
@@ -80,7 +80,7 @@
             msg += '<input type=password size=10 id="password_input" class="noVNC_status">';
             msg += '<\/form>';
             $D('noVNC_status_bar').setAttribute("class", "noVNC_status_warn");
-            $D('noVNC_status').innerHTML = msg;
+            $D('noVNC_status').textContent = msg;
         }
         function setPassword() {
             rfb.sendPassword($D('password_input').value);
@@ -109,7 +109,7 @@
 
             if (typeof(msg) !== 'undefined') {
                 sb.setAttribute("class", "noVNC_status_" + level);
-                s.innerHTML = msg;
+                s.textContent = msg;
             }
         }
 
